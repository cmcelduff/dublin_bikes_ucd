<!DOCTYPE html>
<html lang="en">
<head>
    <title>My Google Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
</head>
<body>

    <header id="heading-banner">
        <h1>Dublin Bikes</h1>
    </header>

    <div id="weather"></div>

    

    <div id="user_choice">
        <div id="station_selection"></div>
    </div>

    

    <div id="map"></div>
    <script>
        var map;
    
        function addMarkers(stations) {
          for (const station of stations) {
            console.log(station);
            var marker = new google.maps.Marker({
              position: {
                lat: station.position_lat,
                lng: station.position_lng,
              },
              map: map,
              title: station.name,
              station_number: station.number,
            });
          }
        }
    
        function getStations() {
          fetch("/stations")
            .then((response) => response.json())
            .then((data) => {
              console.log("fetch response", typeof data);
              addMarkers(data);
            });
        }
    
        // Initialize and add the map
        function initMap() {
          const dublin = { lat: 53.35014, lng: -6.266155 };
          // The map, centered at Dublin
          map = new google.maps.Map(document.getElementById("map"), {
            zoom: 14,
            center: dublin,
          });
          // const marker = new google.maps.Marker({
          // position: dublin,
          // map: map,
          // });
          getStations();
        }
        
        var map = null;
        window.initMap = initMap;
      </script>

    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?
key=AIzaSyDb1zt2yFhv6A2dHezuG3hzGh9kva2R4OE&callback=initMap" async defer></script>

</body>
</html>